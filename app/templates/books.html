<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Books - Rebookify</title>
</head>
<body>
  <h1>Books</h1>

  <form method="GET" action="{{ url_for('books') }}">
    <input type="text" name="title" placeholder="Search by Title" value="{{ title }}">
    <input type="text" name="author" placeholder="Search by Author" value="{{ author }}">
    <input type="number" step="0.01" name="min_price" placeholder="Min Price" value="{{ min_price }}">
    <input type="number" step="0.01" name="max_price" placeholder="Max Price" value="{{ max_price }}">
    <input type="submit" value="Search">
    <a href="{{ url_for('books') }}">Clear</a>
  </form>

  <p><a href="{{ url_for('add_book') }}">Add New Book</a></p>

  <ul>
    {% for book in books %}
      <li>
        <strong>{{ book.title }}</strong> by {{ book.author }} - ${{ "%.2f"|format(book.price) }}<br/>
        Condition: {{ book.condition }}<br/>
        <p>{{ book.description }}</p>
        {% if book.image_url %}
          <img src="{{ book.image_url }}" alt="Book image" width="150"/>
        {% endif %}
        <p>Seller: {{ book.seller.name }}</p>
        <p><a href="{{ url_for('messages', user_id=book.seller.id) }}">Message Seller</a></p>
        {% if current_user.is_authenticated and current_user.id == book.seller.id %}
          <p>
            <a href="{{ url_for('edit_book', book_id=book.id) }}">Edit</a> |
            <form method="POST" action="{{ url_for('delete_book', book_id=book.id) }}" style="display:inline;" onsubmit="return confirm('Are you sure?');">
              <button type="submit">Delete</button>
            </form>
          </p>
        {% endif %}
      </li>
    {% else %}
      <li>No books found.</li>
    {% endfor %}
  </ul>

  <p><a href="{{ url_for('home') }}">Back to Home</a></p>
</body>
</html>
