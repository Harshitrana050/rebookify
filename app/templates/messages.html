<!DOCTYPE html>
<html>
<head><title>Messages with {{ other_user.name }}</title></head>
<body>
  <h2>Conversation with {{ other_user.name }}</h2>
  <ul>
    {% for msg in conversation %}
      <li>
        <strong>{{ 'You' if msg.sender_id == current_user.id else other_user.name }}:</strong> {{ msg.message_text }}<br>
        <small>{{ msg.timestamp.strftime('%Y-%m-%d %H:%M:%S') }}</small>
      </li>
    {% else %}
      <li>No messages yet.</li>
    {% endfor %}
  </ul>
  <form method="POST">
    <textarea name="message" rows="3" cols="40" placeholder="Type your message here..." required></textarea><br>
    <input type="submit" value="Send">
  </form>
  <p><a href="{{ url_for('books') }}">Back to Books</a></p>
</body>
</html>
